# ParticleSystem

все обновление происходит в WorkerThread, test::update только изменяет globalTime.

в ParticleController::Update считаем сколько активных частиц, в зависимости от этого выбираем на сколько асинхронных частей дробить апдейт.

в апдейте частицы, если она мертва то сдвигаем первый элемент вперед, декрементим количество частиц и эмитим новый взрыв с каким то рандомом. если нет то обновляем позицию.
на эмите инкрементим количество частиц, и сдвигаем вперед индекс следующей для эмита частицы.

в системе реализован тройной буффер. в конце апдейта свапаем один из апдейт буфферов.

в конце рендера свапаем рендер буффер.

индексы первой и следующей частицы и количество активных элементов ввиде массива, чтобы на каждый буффер был свой экземпляр.

при работе использовались материалы:
первые 4 главы книги Anthony Williams "C++ Concurrency in action"
https://en.wikipedia.org/wiki/Multiple_buffering
http://gameprogrammingpatterns.com/double-buffer.html